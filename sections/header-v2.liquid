<div
  class="header-v2 page-width"
  data-section-id="{{ section.id }}"
  data-section-type="header">
  <div class="header-v2__top">
    <!-- Search -->
    <div class="header-v2__search-container">
      <button
        type="button"
        class="header-v2__search-toggle"
        aria-expanded="false"
        aria-controls="SearchDrawer"
      >
        <span class="visually-hidden">{{ 'general.search.search' }}</span>
        <svg
          aria-hidden="true"
          focusable="false"
          class="icon icon-search"
          viewBox="0 0 24 24"
        >
          <path d="M21.71 20.29L18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.39zM11 18a7 7 0 1 1 7-7 7 7 0 0 1-7 7z" />
        </svg>
        <span class="header-v2__search-text">Search</span>
      </button>
      <div id="SearchDrawer" class="header-v2__search-drawer">
        <div class="header-v2__search-form-wrapper">
          <form
            action="{{ routes.search_url }}"
            method="get"
            role="search"
            class="header-v2__search-form"
          >
            <div class="header-v2__search-input-wrapper">
              <input
                type="search"
                name="q"
                placeholder="Search here..."
                class="header-v2__search-input"
                aria-label="{{ 'general.search.placeholder' }}"
                autocomplete="off"
                data-predictive-search
              >
              <button type="submit" class="header-v2__search-submit">
                <span class="visually-hidden">Submit</span>
                <svg aria-hidden="true" focusable="false" class="icon icon-search" viewBox="0 0 24 24">
                  <path d="M21.71 20.29L18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.39zM11 18a7 7 0 1 1 7-7 7 7 0 0 1-7 7z" />
                </svg>
              </button>
              <div class="predictive-search" hidden>
                <div class="predictive-search__loading-state">
                  <svg aria-hidden="true" focusable="false" class="spinner" viewBox="0 0 66 66">
                    <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                  </svg>
                </div>
                <div class="predictive-search__results"></div>
              </div>
            </div>
          </form>
          <button type="button" class="header-v2__search-close" aria-label="{{ 'general.search.close' }}">
            <svg aria-hidden="true" focusable="false" class="icon icon-close" viewBox="0 0 24 24">
              <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Logo -->
    <div class="header-v2__logo-container">
      {%- if section.settings.logo != blank -%}
        <a href="{{ routes.root_url }}" class="header-v2__logo-link">
          {%- assign logo_alt = section.settings.logo.alt | default: shop.name | escape -%}
          {%- assign logo_width = section.settings.logo_width | default: 100 -%}
          {%- assign logo_height = section.settings.logo.height
            | divided_by: section.settings.logo.width
            | times: logo_width
            | round
          -%}
          {{
            section.settings.logo
            | image_url: width: section.settings.logo.width
            | image_tag:
              class: 'header-v2__logo',
              widths: '50, 100, 150, 200, 250, 300, 400, 500',
              height: logo_height,
              width: logo_width,
              alt: logo_alt,
              loading: 'eager'
          }}
        </a>
      {%- else -%}
        <a href="{{ routes.root_url }}" class="header-v2__logo-link header-v2__logo-text">
          {{ shop.name }}
        </a>
      {%- endif -%}
    </div>

    <!-- Cart and Language -->
    <div class="header-v2__actions">
      {%- if section.settings.show_language_selector -%}
        <div class="header-v2__localization">
          {%- form 'localization', id: 'HeaderCountryForm', class: 'localization-form' -%}
            <div class="localization-form__select">
              <h2 class="visually-hidden" id="HeaderCountryLabel">{{ 'country selector' }}</h2>
              <select
                class="localization-selector link"
                name="country_code"
                aria-labelledby="HeaderCountryLabel"
              >
                {%- for country in localization.available_countries -%}
                  <option
                    value="{{ country.iso_code }}"
                    {%- if country.iso_code == localization.country.iso_code %}
                      selected
                    {% endif %}
                  >
                    {{ country.name }} ({{ country.iso_code }})
                  </option>
                {%- endfor -%}
              </select>
              <svg
                aria-hidden="true"
                focusable="false"
                class="icon icon-caret"
                viewBox="0 0 10 6"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M9.354.646a.5.5 0 00-.708 0L5 4.293 1.354.646a.5.5 0 00-.708.708l4 4a.5.5 0 00.708 0l4-4a.5.5 0 000-.708z"
                  fill="currentColor">
              </svg>
            </div>
            <button class="button button--tertiary visually-hidden" aria-label="{{ 'general.country.update' }}">
              {{ 'general.country.update' }}
            </button>
          {%- endform -%}
        </div>
      {%- endif -%}

      <a href="{{ routes.cart_url }}" class="header-v2__cart-link js-cart-drawer-trigger">
        <svg
          aria-hidden="true"
          focusable="false"
          class="icon icon-cart"
          viewBox="0 0 24 24"
        >
          <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z" />
        </svg>
        <span class="header-v2__cart-count">{{ cart.item_count }}</span>
        <span class="header-v2__cart-text">Cart</span>
      </a>
    </div>
  </div>

  <!-- Navigation -->
  <div class="header-v2__navigation">
    <nav class="header-v2__nav" role="navigation">
      <ul class="header-v2__menu list-unstyled">
        {%- for link in section.settings.menu.links -%}
          <li class="header-v2__menu-item{% if link.links.size > 0 %} header-v2__menu-item--has-submenu{% endif %}{% assign is_mega_menu = false %}{% for block in section.blocks %}{% if block.type == 'mega_menu' and link.title == block.settings.mega_menu_title %}{% assign is_mega_menu = true %}{% assign mega_menu_block = block %}{% endif %}{% endfor %}{% if is_mega_menu %} header-v2__menu-item--mega postionStatic{% endif %}">
            <a
              href="{{ link.url }}"
              class="header-v2__menu-link{% if link.active %} header-v2__menu-link--active{% endif %}"
            >
              {{ link.title }}
              {%- if link.links.size > 0 -%}
                <svg
                  aria-hidden="true"
                  focusable="false"
                  class="icon icon-chevron-down"
                  viewBox="0 0 24 24"
                >
                  <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
                </svg>
              {%- endif -%}
            </a>
            {%- if link.links.size > 0 -%}
              {% if is_mega_menu %}
                <div class="page-width header-v2__mega-menu">
                  <div class="header-v2__mega-menu-container">
                    <div class="header-v2__mega-menu-links">
                      <h6>{{ mega_menu_block.settings.menu_heading }}</h6>
                      {%- for childlink in link.links -%}
                        <div class="header-v2__mega-menu-column">
                          <a
                            href="{{ childlink.url }}"
                            class="header-v2__mega-menu-title{% if childlink.active %} header-v2__mega-menu-title--active{% endif %}"
                          >
                            {{ childlink.title }}
                          </a>
                          {% if childlink.links.size > 0 %}
                            <ul class="header-v2__mega-menu-list list-unstyled">
                              {%- for grandchildlink in childlink.links -%}
                                <li class="header-v2__mega-menu-item">
                                  <a
                                    href="{{ grandchildlink.url }}"
                                    class="header-v2__mega-menu-link{% if grandchildlink.active %} header-v2__mega-menu-link--active{% endif %}"
                                  >
                                    {{ grandchildlink.title }}
                                  </a>
                                </li>
                              {%- endfor -%}
                            </ul>
                          {% endif %}
                        </div>
                      {%- endfor -%}
                    </div>
                    {% if mega_menu_block.settings.mega_menu_image != blank %}
                      <div class="header-v2__mega-menu-featured">
                        <div class="header-v2__mega-menu-image-wrapper">
                          {% if mega_menu_block.settings.mega_menu_image_link != blank %}
                            <a href="{{ mega_menu_block.settings.mega_menu_image_link }}">
                          {% endif %}
                          <img
                            src="{{ mega_menu_block.settings.mega_menu_image | img_url: 'medium' }}"
                            alt="{{ mega_menu_block.settings.mega_menu_image.alt | default: mega_menu_block.settings.mega_menu_image_heading }}"
                            class="header-v2__mega-menu-image"
                            loading="lazy"
                          >
                          {% if mega_menu_block.settings.mega_menu_show_badge %}
                            <span class="header-v2__mega-menu-badge">
                              {{- mega_menu_block.settings.mega_menu_badge_text -}}
                            </span>
                          {% endif %}
                          {% if mega_menu_block.settings.mega_menu_image_link != blank %}
                            </a>
                          {% endif %}
                        </div>
                        <div class="header-v2__content">
                          {% if mega_menu_block.settings.mega_menu_image_heading != blank %}
                            <h3 class="header-v2__mega-menu-image-heading">
                              {{ mega_menu_block.settings.mega_menu_image_heading }}
                            </h3>
                          {% endif %}
                          {% if mega_menu_block.settings.mega_menu_image_text != blank %}
                            <p class="header-v2__mega-menu-image-text">
                              {{ mega_menu_block.settings.mega_menu_image_text }}
                            </p>
                          {% endif %}
                        </div>
                      </div>
                    {% endif %}
                    {% if mega_menu_block.settings.mega_menu_image2 != blank %}
                      <div class="header-v2__mega-menu-featured">
                        <div class="header-v2__mega-menu-image-wrapper">
                          {% if mega_menu_block.settings.mega_menu_image_link2 != blank %}
                            <a href="{{ mega_menu_block.settings.mega_menu_image_link2 }}">
                          {% endif %}
                          <img
                            src="{{ mega_menu_block.settings.mega_menu_image2 | img_url: 'medium' }}"
                            alt="{{ mega_menu_block.settings.mega_menu_image2.alt | default: mega_menu_block.settings.mega_menu_image_heading2 }}"
                            class="header-v2__mega-menu-image"
                            loading="lazy"
                          >
                          {% if mega_menu_block.settings.mega_menu_show_badge2 %}
                            <span class="header-v2__mega-menu-badge">
                              {{- mega_menu_block.settings.mega_menu_badge_text2 -}}
                            </span>
                          {% endif %}
                          {% if mega_menu_block.settings.mega_menu_image_link2 != blank %}
                            </a>
                          {% endif %}
                        </div>
                        <div class="header-v2__content">
                          {% if mega_menu_block.settings.mega_menu_image_heading2 != blank %}
                            <h3 class="header-v2__mega-menu-image-heading">
                              {{ mega_menu_block.settings.mega_menu_image_heading2 }}
                            </h3>
                          {% endif %}
                          {% if mega_menu_block.settings.mega_menu_image_text2 != blank %}
                            <p class="header-v2__mega-menu-image-text">
                              {{ mega_menu_block.settings.mega_menu_image_text2 }}
                            </p>
                          {% endif %}
                        </div>
                      </div>
                    {% endif %}
                  </div>
                </div>
              {% else %}
                <ul class="header-v2__submenu list-unstyled">
                  {%- for childlink in link.links -%}
                    <li class="header-v2__submenu-item">
                      <a
                        href="{{ childlink.url }}"
                        class="header-v2__submenu-link{% if childlink.active %} header-v2__submenu-link--active{% endif %}"
                      >
                        {{ childlink.title }}
                      </a>
                    </li>
                  {%- endfor -%}
                </ul>
              {% endif %}
            {%- endif -%}
          </li>
        {%- endfor -%}
      </ul>
    </nav>
  </div>

  <!-- Mobile menu toggle -->
  <button
    type="button"
    class="header-v2__mobile-toggle"
    aria-expanded="false"
    aria-controls="MobileNav"
  >
    <span class="visually-hidden">{{ 'general.navigation.menu' }}</span>
    <svg
      aria-hidden="true"
      focusable="false"
      class="icon icon-hamburger"
      viewBox="0 0 24 24"
    >
      <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
    </svg>
  </button>

  <!-- Mobile menu -->
  <div id="MobileNav" class="header-v2__mobile-nav">
    <div class="header-v2__mobile-nav-inner">
      <button
        type="button"
        class="header-v2__mobile-close"
        aria-label="{{ 'general.navigation.close_menu' }}"
      >
        <svg
          aria-hidden="true"
          focusable="false"
          class="icon icon-close"
          viewBox="0 0 24 24"
        >
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
        </svg>
      </button>
      <nav class="header-v2__mobile-menu" role="navigation">
        <ul class="header-v2__mobile-menu-list list-unstyled">
          {%- for link in section.settings.menu.links -%}
            <li class="header-v2__mobile-menu-item{% if link.links.size > 0 %} header-v2__mobile-menu-item--has-submenu{% endif %}">
              <a
                href="{{ link.url }}"
                class="header-v2__mobile-menu-link{% if link.active %} header-v2__mobile-menu-link--active{% endif %}"
              >
                {{ link.title }}
              </a>
              {%- if link.links.size > 0 -%}
                <button class="header-v2__mobile-submenu-toggle" aria-expanded="false">
                  <span class="visually-hidden">{{ 'general.navigation.expand_submenu' }}</span>
                  <svg
                    aria-hidden="true"
                    focusable="false"
                    class="icon icon-plus"
                    viewBox="0 0 24 24"
                  >
                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
                  </svg>
                </button>
                <ul class="header-v2__mobile-submenu list-unstyled">
                  {%- for childlink in link.links -%}
                    <li class="header-v2__mobile-submenu-item">
                      <a
                        href="{{ childlink.url }}"
                        class="header-v2__mobile-submenu-link{% if childlink.active %} header-v2__mobile-submenu-link--active{% endif %}"
                      >
                        {{ childlink.title }}
                      </a>
                    </li>
                  {%- endfor -%}
                </ul>
              {%- endif -%}
            </li>
          {%- endfor -%}
        </ul>
      </nav>
    </div>
  </div>

  <!-- Include the cart drawer -->
  {% render 'ajax-cart-drawer' %}
</div>

<style>
  .header-v2 {
    position: relative;
    padding-top: 2rem;
    padding-bottom: 2rem;
  }

  .header-v2__top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }

  /* Logo */
  .header-v2__logo-container {
    text-align: center;
  }

  .header-v2__logo {
    max-width: {{ section.settings.logo_width }}px;
    display: block;
    margin: 0 auto;
    height: auto;
  }

  .header-v2__logo-text {
    font-size: 24px;
    font-weight: 700;
    text-decoration: none;
    color: {{ section.settings.heading_color }};
  }

  /* Search */
  .header-v2__search-container {
    position: relative;
  }

  .header-v2__search-toggle {
    display: flex;
    align-items: center;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
    color: {{ section.settings.text_color }};
  }

  .header-v2__search-text {
    margin-left: 5px;
    display: none;
  }

  @media screen and (min-width: 750px) {
    .header-v2__search-text {
      display: inline-block;
    }
  }

  .header-v2__search-drawer {
    position: absolute;
    top: 100%;
    left: 0;
    width: 400px;
    background: #fff;
    padding: 15px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    z-index: 10;
    display: none;
  }

  .header-v2__search-drawer.active {
    display: block;
  }

  .header-v2__search-form-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .header-v2__search-form {
    display: flex;
    flex: 1;
  }

  .header-v2__search-input-wrapper {
    position: relative;
    flex-grow: 1;
  }

  .header-v2__search-input {
    width: 100%;
    padding: 10px 40px 10px 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
  }

  .header-v2__search-submit {
    position: absolute;
    right: 0;
    top: 0;
    height: 100%;
    background: none;
    border: none;
    padding: 0 10px;
    cursor: pointer;
  }

  .header-v2__search-close {
    position: absolute;
    right: -5px;
    top: -5px;
    background: none;
    border: none;
    padding: 5px;
    cursor: pointer;
    position: static !important;
  }

  /* Actions (Cart and Language) */
  .header-v2__actions {
    display: flex;
    align-items: center;
  }

  .header-v2__localization {
    margin-right: 20px;
  }

  .header-v2 .localization-form__select {
    position: relative;
  }

  .header-v2 .localization-selector {
    appearance: none;
    background: transparent;
    border: none;
    padding-right: 15px;
    cursor: pointer;
    color: {{ section.settings.text_color }};
  }

  .header-v2 .icon-caret {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 10px;
    height: 6px;
    pointer-events: none;
  }

  .header-v2__cart-link {
    display: flex;
    align-items: center;
    text-decoration: none;
    color: {{ section.settings.text_color }};
    position: relative;
  }

  .header-v2__cart-count {
    position: absolute;
    top: -8px;
    right: -8px;
    background-color: {{ section.settings.accent_color }};
    color: #fff;
    font-size: 12px;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .header-v2__cart-text {
    margin-left: 5px;
    display: none;
  }

  @media screen and (min-width: 750px) {
    .header-v2__cart-text {
      display: inline-block;
    }
  }

  /* Navigation */
  .header-v2__navigation {
    border-top: 1px solid{{ section.settings.border_color }};
    padding-top: 15px;
  }

  .header-v2__menu {
    display: flex;
    justify-content: center;
    margin: 0;
    padding: 0;
  }

  .header-v2__menu-item {
    position: relative;
    margin: 0 15px;
  }

  .postionStatic{
    position: static!important;
  }

  .header-v2__menu-link {
    display: flex;
    align-items: center;
    text-decoration: none;
    color: {{ section.settings.text_color }};
    padding: 5px 0;
    font-weight: 500;
  }


  .header-v2 .icon-chevron-down {
    width: 16px;
    height: 16px;
    margin-left: 5px;
  }

  .header-v2__submenu {
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 200px;
    background: #fff;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    padding: 10px 0;
    z-index: 10;
    display: none;
    animation: slideDown 0.3s ease-in-out;
  }

  .header-v2__menu-item:hover .header-v2__submenu {
    display: block;
  }

  .header-v2__submenu-item {
    padding: 0 15px;
  }

  .header-v2__submenu-link {
    display: block;
    text-decoration: none;
    color: {{ section.settings.text_color }};
    padding: 8px 0;
  }

  .header-v2__submenu-link--active {
    color: {{ section.settings.accent_color }};
  }

  /* Mobile menu */
  .header-v2__mobile-toggle {
    display: none;
    position: absolute;
    top: 15px;
    right: 15px;
    background: none;
    border: none;
    padding: 5px;
    cursor: pointer;
    z-index: 5;
  }

  .header-v2__mobile-nav {
    display: none;
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    width: 300px;
    background: #fff;
    z-index: 100;
    overflow-y: auto;
    transform: translateX(100%);
    transition: transform 0.3s ease;
  }

  .header-v2__mobile-nav.active {
    transform: translateX(0);
  }

  .header-v2__mobile-nav-inner {
    padding: 20px;
  }

  .header-v2__mobile-close {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    padding: 5px;
    cursor: pointer;
  }

  .header-v2__mobile-menu-list {
    margin: 30px 0 0;
    padding: 0;
  }

  .header-v2__mobile-menu-item {
    margin-bottom: 10px;
    position: relative;
  }

  .header-v2__mobile-menu-link {
    display: block;
    text-decoration: none;
    color: {{ section.settings.text_color }};
    padding: 10px 0;
    font-weight: 500;
  }

  .header-v2__mobile-menu-link--active {
    color: {{ section.settings.accent_color }};
  }

  .header-v2__mobile-submenu-toggle {
    position: absolute;
    top: 5px;
    right: 0;
    background: none;
    border: none;
    padding: 5px;
    cursor: pointer;
  }

  .header-v2__mobile-submenu {
    display: none;
    margin: 0;
    padding: 0 0 0 15px;
  }

  .header-v2__mobile-submenu.active {
    display: block;
  }

  .header-v2__mobile-submenu-item {
    margin-bottom: 5px;
  }

  .header-v2__mobile-submenu-link {
    display: block;
    text-decoration: none;
    color: {{ section.settings.text_color }};
    padding: 8px 0;
  }

  .header-v2__mobile-submenu-link--active {
    color: {{ section.settings.accent_color }};
  }

  .header-v2 .list-unstyled {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .header-v2 .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    margin: -1px;
    padding: 0;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    border: 0;
  }

  .header-v2 .icon {
    width: 24px;
    height: 24px;
    fill: currentColor;
  }

  .header-v2 .localization-form__select .icon-caret {
    width: 12px !important;
  }

  a.header-v2__menu-link.header-v2__menu-link--active:after {
    content: '';
    height: 2px;
    width: 120%;
    background: #000;
    position: absolute;
    bottom: 0;
    transform: translateX(-50%);
    left: 50%;
    display: none;
  }

  /* Add these styles to your existing styles */
  .predictive-search {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: #fff;
    border: 1px solid #ddd;
    border-top: none;
    max-height: 400px;
    overflow-y: auto;
    z-index: 11;
  }

  .predictive-search__loading-state {
    display: none;
    padding: 20px;
    text-align: center;
  }

  .predictive-search__loading-state.active {
    display: block;
  }

  .predictive-search__results {
    padding: 15px;
  }

  .predictive-search-item {
    display: flex;
    align-items: center;
    padding: 10px;
    text-decoration: none;
    color: inherit;
    transition: background-color 0.2s;
  }

  .predictive-search-item:hover {
    background-color: #f5f5f5;
  }

  .predictive-search-item__image {
    width: 50px;
    height: 50px;
    margin-right: 15px;
    object-fit: cover;
  }

  .predictive-search-item__info {
    flex: 1;
  }

  .predictive-search-item__title {
    margin: 0 0 5px;
    font-weight: 500;
  }

  .predictive-search-item__price {
    color: {{ section.settings.accent_color }};
    font-weight: 600;
  }

  .spinner {
    animation: rotator 1.4s linear infinite;
    width: 24px;
    height: 24px;
  }

  .spinner .path {
    stroke: {{ section.settings.accent_color }};
    animation: dash 1.4s ease-in-out infinite;
  }

  @keyframes rotator {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(270deg); }
  }

  @keyframes dash {
    0% { stroke-dashoffset: 187; }
    50% { stroke-dashoffset: 46.75; transform: rotate(135deg); }
    100% { stroke-dashoffset: 187; transform: rotate(450deg); }
  }

  /* Responsive */
  @media screen and (max-width: 989px) {
    .header-v2__navigation {
      display: none;
    }

    .header-v2__mobile-toggle {
      display: block;
    }

    .header-v2__mobile-nav {
      display: block;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Search toggle
    const searchToggle = document.querySelector('.header-v2__search-toggle');
    const searchDrawer = document.querySelector('.header-v2__search-drawer');
    const searchClose = document.querySelector('.header-v2__search-close');

    if (searchToggle && searchDrawer && searchClose) {
      searchToggle.addEventListener('click', function () {
        searchDrawer.classList.toggle('active');
        searchToggle.setAttribute('aria-expanded', searchDrawer.classList.contains('active'));
      });

      searchClose.addEventListener('click', function () {
        searchDrawer.classList.remove('active');
        searchToggle.setAttribute('aria-expanded', 'false');
      });
    }

    // Mobile menu
    const mobileToggle = document.querySelector('.header-v2__mobile-toggle');
    const mobileNav = document.querySelector('.header-v2__mobile-nav');
    const mobileClose = document.querySelector('.header-v2__mobile-close');
    const submenuToggles = document.querySelectorAll('.header-v2__mobile-submenu-toggle');

    if (mobileToggle && mobileNav && mobileClose) {
      mobileToggle.addEventListener('click', function () {
        mobileNav.classList.add('active');
        mobileToggle.setAttribute('aria-expanded', 'true');
      });

      mobileClose.addEventListener('click', function () {
        mobileNav.classList.remove('active');
        mobileToggle.setAttribute('aria-expanded', 'false');
      });
    }

    if (submenuToggles.length > 0) {
      submenuToggles.forEach(function (toggle) {
        toggle.addEventListener('click', function () {
          const submenu = this.nextElementSibling;
          submenu.classList.toggle('active');
          this.setAttribute('aria-expanded', submenu.classList.contains('active'));

          // Change icon from plus to minus or vice versa
          const icon = this.querySelector('.icon');
          if (submenu.classList.contains('active')) {
            icon.innerHTML = '<path d="M19 13H5v-2h14v2z"/>';
            icon.classList.remove('icon-plus');
            icon.classList.add('icon-minus');
          } else {
            icon.innerHTML = '<path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>';
            icon.classList.remove('icon-minus');
            icon.classList.add('icon-plus');
          }
        });
      });
    }

    // Auto-submit country selector on change
    const countrySelector = document.querySelector('#HeaderCountryForm .localization-selector');
    if (countrySelector) {
      countrySelector.addEventListener('change', function () {
        this.form.submit();
      });
    }
  });
</script>

<script>
  // Add this to your existing script
  document.addEventListener('DOMContentLoaded', function () {
    // Existing code...
    // Cart drawer functionality
    const cartDrawer = document.getElementById('CartDrawer');
    const cartDrawerOverlay = document.getElementById('CartDrawerOverlay');
    const cartTrigger = document.querySelector('.js-cart-drawer-trigger');
    const cartClose = document.querySelector('.cart-drawer__close');

    function openCartDrawer() {
      if (cartDrawer && cartDrawerOverlay) {
        cartDrawer.classList.add('active');
        cartDrawerOverlay.classList.add('active');
        document.body.style.overflow = 'hidden';
      }
    }

    function closeCartDrawer() {
      if (cartDrawer && cartDrawerOverlay) {
        cartDrawer.classList.remove('active');
        cartDrawerOverlay.classList.remove('active');
        document.body.style.overflow = '';
      }
    }

    if (cartTrigger) {
      cartTrigger.addEventListener('click', function (e) {
        e.preventDefault();
        openCartDrawer();
      });
    }

    if (cartClose) {
      cartClose.addEventListener('click', closeCartDrawer);
    }

    if (cartDrawerOverlay) {
      cartDrawerOverlay.addEventListener('click', closeCartDrawer);
    }
  });
</script>

<script>
  class PredictiveSearch {
    constructor() {
      this.input = document.querySelector('[data-predictive-search]');
      this.results = document.querySelector('.predictive-search');
      this.loadingState = document.querySelector('.predictive-search__loading-state');
      this.resultsContainer = document.querySelector('.predictive-search__results');

      this.setupEventListeners();
      this.debounceTimeout = null;
    }

    setupEventListeners() {
      if (!this.input) return;

      this.input.addEventListener('input', () => {
        clearTimeout(this.debounceTimeout);
        this.debounceTimeout = setTimeout(() => {
          this.performSearch();
        }, 300);
      });

      this.input.addEventListener('focus', () => {
        this.results.hidden = false;
      });

      document.addEventListener('click', (event) => {
        if (!this.results.contains(event.target) && !this.input.contains(event.target)) {
          this.results.hidden = true;
        }
      });
    }

    async performSearch() {
      const searchTerm = this.input.value.trim();

      if (searchTerm.length < 2) {
        this.results.hidden = true;
        return;
      }

      this.results.hidden = false;
      this.loadingState.classList.add('active');
      this.resultsContainer.innerHTML = '';

      try {
        const response = await fetch(
          `/search/suggest.json?q=${encodeURIComponent(searchTerm)}&resources[type]=product`
        );
        const data = await response.json();

        this.loadingState.classList.remove('active');
        this.displayResults(data.resources.results.products);
      } catch (error) {
        console.error('Error performing search:', error);
        this.loadingState.classList.remove('active');
      }
    }

    displayResults(products) {
      if (!products || products.length === 0) {
        this.resultsContainer.innerHTML = '<p>No results found</p>';
        return;
      }

      const resultsHTML = products
        .map(
          (product) => `
        <a href="${product.url}" class="predictive-search-item">
          <img 
            src="${product.featured_image.url}" 
            alt="${product.title}"
            class="predictive-search-item__image"
            loading="lazy"
          >
          <div class="predictive-search-item__info">
            <h4 class="predictive-search-item__title">${product.title}</h4>
            <div class="predictive-search-item__price">${product.price}</div>
          </div>
        </a>  
      `
        )
        .join('');

      this.resultsContainer.innerHTML = resultsHTML;
    }
  }

  // Initialize predictive search
  document.addEventListener('DOMContentLoaded', function () {
    new PredictiveSearch();
  });
</script>

{% schema %}
{
  "name": "Header V2",
  "class": "section-header-v2",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 300,
      "step": 10,
      "default": 150,
      "unit": "px",
      "label": "Logo width"
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    },
    {
      "type": "header",
      "content": "Language selector",
      "info": "To add a language, go to your [language settings.](/admin/settings/languages)"
    },
    {
      "type": "checkbox",
      "id": "show_language_selector",
      "default": true,
      "label": "Show language selector"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "heading_color",
      "default": "#000000",
      "label": "Heading color"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#333333",
      "label": "Text color"
    },
    {
      "type": "color",
      "id": "accent_color",
      "default": "#0066cc",
      "label": "Accent color"
    },
    {
      "type": "color",
      "id": "border_color",
      "default": "#dddddd",
      "label": "Border color"
    }
  ],
  "blocks": [
    {
      "type": "mega_menu",
      "name": "Mega Menu",
      "limit": 5,
      "settings": [
        {
          "type": "text",
          "id": "mega_menu_title",
          "label": "Menu Title",
          "info": "Enter the exact title of the menu item that should display as a mega menu",
          "default": "Shop"
        },
        {
          "type": "text",
          "id": "menu_heading",
          "label": "Menu Heading",
          "default": "Shop All Categories"
        },
        {
          "type": "image_picker",
          "id": "mega_menu_image",
          "label": "Featured Image"
        },
        {
          "type": "url",
          "id": "mega_menu_image_link",
          "label": "Featured Image Link"
        },
        {
          "type": "text",
          "id": "mega_menu_image_heading",
          "label": "Featured Image Heading",
          "default": "Featured Product"
        },
        {
          "type": "text",
          "id": "mega_menu_image_text",
          "label": "Featured Image Text",
          "default": "Check out our latest products"
        },
        {
          "type": "checkbox",
          "id": "mega_menu_show_badge",
          "label": "Show Badge",
          "default": true
        },
        {
          "type": "text",
          "id": "mega_menu_badge_text",
          "label": "Badge Text",
          "default": "Best Seller"
        },
        {
          "type": "image_picker",
          "id": "mega_menu_image2",
          "label": "Featured Image 2"
        },
        {
          "type": "url",
          "id": "mega_menu_image_link2",
          "label": "Featured Image Link 2"
        },
        {
          "type": "text",
          "id": "mega_menu_image_heading2",
          "label": "Featured Image Heading 2",
          "default": "Featured Product 2"
        },
        {
          "type": "text",
          "id": "mega_menu_image_text2",
          "label": "Featured Image Text 2",
          "default": "Check out our latest products 2"
        },
        {
          "type": "checkbox",
          "id": "mega_menu_show_badge2",
          "label": "Show Badge 2",
          "default": true
        },
        {
          "type": "text",
          "id": "mega_menu_badge_text2",
          "label": "Badge Text 2",
          "default": "Best Seller 2"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Header V2",
      "category": "Header"
    }
  ]
}
{% endschema %}    

<style>
    /* Mega Menu */
    .header-v2__mega-menu {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      top: 86%;
      width: 100vw;
      background: #fff;
      /* box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); */
      border-top: 1px solid #eee;
      padding-top: 2.4rem;
      padding-bottom: 2.4rem;
      z-index: 10;
      display: none;
      /* display: block; */
    }

    .header-v2__menu-item--mega:hover .header-v2__mega-menu {
      display: block;
      transition: all 0.3s ease-in-out;
      animation: slideDown 0.3s ease-in-out;
    }

    @keyframes slideDown {
      0% {
        opacity: 0;
        transform: translateY(-10px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .header-v2__mega-menu-container {
      display: flex;
      gap: 30px;
      max-width: 800px;
      margin: auto;
    }

    .header-v2__mega-menu-links {
      display: flex;
      flex-direction: column;
      /* flex-wrap: wrap; */
      /* gap: 30px; */
      flex: 1;
      max-width: 50%;
    }
    .header-v2__mega-menu-links h6 {
      margin: 0 0 4px;
      font-size: 17px;
      font-weight: 800;
      color: #000;
    }

    .header-v2__mega-menu-column {
    ;


    /*

     flex: 1;
     min-width: 160px;
  */
  }

  .header-v2__mega-menu-title {
    display: block;
    font-weight: 600;
    font-size: 14px;
    margin-bottom: 0;
    text-decoration: none;
    color: {{ section.settings.text_color }};
  }

  .header-v2__mega-menu-title--active {
    color: {{ section.settings.accent_color }};
  }

  .header-v2__mega-menu-list {
    margin: 0;
    padding: 0;
  }

  .header-v2__mega-menu-item {
    margin-bottom: 10px;
  }

  .header-v2__mega-menu-link {
    text-decoration: none;
    color: {{ section.settings.text_color }};
    font-size: 14px;
  }

  .header-v2__mega-menu-link--active {
    color: {{ section.settings.accent_color }};
  }

  .header-v2__mega-menu-featured {
    flex: 1;
    aspect-ratio: 4 / 4.8;
    max-width: 300px;
    position: relative;
  }
  .header-v2__content {
    position: absolute;
    top: 0;
    color: #fff;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: end;
    padding: 20px;
  }

  .header-v2__mega-menu-image-wrapper {
    position: relative;
    margin-bottom: 0;
    height: 100%;
  }

  .header-v2__mega-menu-image {
    width: 100%;
    height: 100%;
    /* height: auto; */
    border-radius: 0;
    object-fit: cover;
  }

  .header-v2__mega-menu-badge {
    position: absolute;
    top: 10px;
    right: 0;
    background-color: {{ section.settings.accent_color }};
    color: #fff;
    font-size: 12px;
    padding: 4px 8px;
    border-radius: 0;
  }

  .header-v2__mega-menu-image-heading {
    font-size: 18px;
    margin: 0;
    font-weight: 600;
    color: #fff;
  }

  .header-v2__mega-menu-image-text {
    font-size: 14px;
    margin: 0;
    color: #fff;
  }

  @media screen and (max-width: 989px) {
    .header-v2__mega-menu {
      display: none !important;
    }
  }
</style>
